<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PGTE Character Sheet Preview</title>
  <style>
/* CSS Variables for easy color management */
:root {
  --placeholder-color: rgba(100, 100, 100, 0.7);
  --text-color: rgba(255, 255, 255, 1);
  --border-color: rgba(255, 255, 255, 0.2);
  --background-light: rgba(255, 255, 255, 0.05);
  --background-medium: rgba(255, 255, 255, 0.1);
  --color-primary: #4E0707; /*wine*/
  --hover-primary: #B90E0A; /*crimson*/
  --roll-stat-name: rgba(114, 47, 55);  /*wine*/
  --roll-stat-name-hover: rgba(114, 47, 55, 0.2); /*pale wine*/
  --success-color: #27ae60;
  --color-primary-light: #710C04; /*blood*/
  --color-primary-light-hover: #B90E0A; /*crimson*/
  --box-shadow: rgba(108, 92, 231, 0.2);
  
  /* Hits visibility controls */
  --hits-physical-opacity: 1;
  --hits-mental-opacity: 0;
  --hits-mental-display: none; /* Set to "flex" to show mental hits column */
  --hits-mental-display-label: 0; /* Set to "1" to show "(Physical)" label when mental shown */
}

  /* CSS Variables for easy color management */


/* Ensure FontAwesome icons work */
.fa, .fa-solid, .fa-regular, .fa-brands {
  font-family: "Font Awesome 6 Free", "Font Awesome 6 Pro", "Font Awesome 6 Brands" !important;
}


/* Character title styling */
.character-title {
  text-align: center;
  font-size: 2.2em;
  margin: 0.5rem 0 1rem 0;
  font-weight: bold;
  max-width: 300px; 
  margin-left: auto; 
  margin-right: auto; 
}

/* Form layout improvements */
.form-row {
  display: flex;
  gap: 1rem;
  justify-content: flex-start;
}

.form-row .form-group {
  flex: 1;
}

.form-row .form-group.expanded {
  flex: 1;
}

.character-info .form-group {
  margin-bottom: 0.5rem;
}

.character-info .form-group label {
  display: block;
  text-align: left;
  font-weight: bold;
  margin-bottom: 0.25rem;
}

/* make these sections wider */
input[name="system.details.characterName"] {
  max-width: 500px;
  min-width: 200px;
}

textarea[name="system.details.archetype"] {
  max-width: 500px;
  min-width: 200px;
}


/* Better placeholder text - using variable */
input::placeholder,
textarea::placeholder {
  color: var(--placeholder-color); 
  font-style: italic;
}

/* Stats table */
.stats-table {
  width: 100%;
  margin-bottom: 1rem;
}

.stats-table th,
.stats-table td {
  padding: 0.5rem;
  text-align: left;
  border-bottom: 1px solid var(--border-color);
}

/* Clickable stat names with boxes */
.roll-stat-name {
  background: var(--background-medium);
  border: 1px solid var(--border-color);
  color: inherit;
  font-weight: bold;
  font-size: inherit;
  cursor: pointer;
  padding: 0.5rem;
  border-radius: 4px;
  transition: all 0.2s;
  width: 100%;
  text-align: left;
}

.roll-stat-name:hover {
  background: var(--roll-stat-name-hover);
  border-color: var(--roll-stat-name-hover);
}

/* Resources row layout */
.resources-row {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr 1fr;
  gap: 2rem;
  margin: 1rem 0;
  padding: 1rem;
  background: rgba(255,255,255,0.05);
  border-radius: 6px;
  align-items: start;
}

.resource-group {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.resource-group h4 {
  margin: 0;
  font-weight: bold;
  font-size: 1rem;
}

/* Mental hits column - controlled by --hits-mental-display flag */
.resource-group:nth-child(2) {
  display: var(--hits-mental-display, none);
}

/* Show "(Physical)" label only when mental hits are shown */
.resource-group:nth-child(1) h4 span {
  opacity: var(--hits-mental-display-label, 0);
}

.resource-group label {
  display: block;
  font-weight: normal;
  margin: 0;
}

/* Hits section redesign */
.hits-section {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.hits-label-row {
  display: flex;
  align-items: center;
}

.hits-control {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.base-hits {
  width: 40px;
  text-align: center;
  font-size: 0.9em;
  margin-left: 0.25rem;
}

.toggle-buttons {
  display: flex;
  flex-direction: column;
  gap: 2px;
}

.toggle-buttons button {
  width: 20px;
  height: 20px;
  padding: 0;
  font-size: 0.8em;
  background: var(--color-primary-light);
  color: white;
  border: none;
  border-radius: 3px;
  cursor: pointer;
}

.toggle-buttons button:hover {
  background: var(--color-primary-light-hover);
}

/* Hit markers - green filled, black empty */
.hits-display {
  display: flex;
  gap: 2px;
  margin-left: 0.5rem;
  align-items: center;
}

.hit-marker {
  font-size: 1.2em;
  cursor: pointer;
  line-height: 1;
}

.hit-marker.filled {
  color: var(--success-color); /* Green */
}

.hit-marker.empty {
  color: #000000; /* Black empty circles */
}

/* Story tokens section */
.tokens-section {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.tokens-control {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.tokens-input {
  width: 60px;
  text-align: center;
}

.tokens-display {
  min-width: 30px;
  text-align: center;
}

/* Story die control */
.story-die-control {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.story-die-select {
  width: auto;
}

/* Roll Story Die button hover effect */
.roll-story-die { 
  background: var(--color-primary-light);
  border: 1px solid var(--border-color);
  color: white;
  padding: 0.5rem;
  border-radius: 4px;
  padding: 4px 8px;
  transition: all 0.2s;
  cursor: pointer;
}

.roll-story-die:hover {
  background: var(--color-primary-light-hover);
  border-color: var(--roll-stat-name-hover);
}


/* Aspects grid layout */
.aspects-grid {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 1rem;
  margin-top: 1rem;
}

/*
.aspects-section {
  padding-left: 1rem;
}*/

.aspect-column {
  flex: 1;
}

.aspect-block {
  border: 1px solid var(--background-medium);
  background: rgba(255,255,255,0.03);
  padding: 0.75rem;
  border-radius: 6px;
  height: 100%;
}

.aspect-header {
  margin-bottom: 0.5rem;
}

.aspect-header label {
  display: block;
  font-weight: bold;
  margin-bottom: 0.25rem;
}

.aspect-header input {
  width: 100%;
  margin-bottom: 0.5rem;
}

.aspect-details textarea {
  width: 100%;
  min-height: 60px;
  resize: vertical;
  margin-bottom: 0.5rem;
}

.aspect-buttons {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.aspect-buttons button {
  background: var(--color-primary);
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 8px;
  font-size: 0.9rem;
  cursor: pointer;
}

.aspect-buttons button:hover {
  background: var(--color-primary-light-hover);
}

/* Bonus dice section */
.bonus-dice-section {
  display: flex;
  gap: 2rem;
  margin: 1rem 0;
  padding: 1rem;
  background: rgba(255,255,255,0.05);
  border-radius: 6px;
}

.item-dice-group {
  flex: 2;
}

.rule-of-cool-group {
  flex: 1;
  text-align: center;
}

.item-dice-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

/*
.item-dice-row input[type="text"] {
  flex: 1;
  min-width: 100px;
} */

.item-dice-row input[type="text"] {
  flex: 4; /* Even bigger for item names */
  min-width: 220px;
}

.item-dice-row select {
  width: 50px; /* Slightly smaller die selector */
  flex-shrink: 0;
}

.item-dice-row button {
  padding: 2px 6px; /* Much smaller roll buttons */
  font-size: 0.8rem;
  flex-shrink: 0;
  max-width: 100px;
}

.item-dice-row select {
  width: 60px;
}

.item-dice-row button,
.rule-of-cool-group button {
  background: var(--color-primary-light);
  color: white;
  border: none;
  border-radius: 4px;
  padding: 4px 8px;  /* smaller than before */
  cursor: pointer;
}

/* Rule of Cool button same width as aspect buttons */
.rule-of-cool-group button {
  display: block;
  width: 100%;
  max-width: 100px; 
  margin: 0 auto;
}

.item-dice-row button:hover,
.rule-of-cool-group button:hover {
  background: var(--color-primary-light-hover);
}

.rule-of-cool-group h4 {
  margin-bottom: 0.5rem;
}

/* Magical Items section adjustments */
.item-dice-group h4 {
  margin-bottom: 0.5rem;
}



.item-dice-row select {
  width: 60px; /* Keep die selector same size */
}



/* Smaller right-aligned Magical Item Roll button */
.item-dice-row button {
  padding: 2px 6px;
  font-size: 0.8rem;
  min-width: 60px; /* smaller footprint */
  margin-left: auto; /* push to far right */
}


/* Items section */
.items-section {
  margin: 1rem 0;
  padding-left: 1rem;
}

.item-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.item-row input[type="text"] {
  flex: 1;
}

.qty-input {
  width: 60px;
  text-align: center;
}

/* Notes section */
.notes-section {
  display: flex;
  gap: 1rem;
  margin: 1rem 0;
  padding-left: 1rem;
  align-items: flex-start;
}

.notes-label {
  flex: 0 0 150px;
}

.notes-label label {
  font-weight: bold;
}

.notes-area {
  flex: 1;
}

.notes-area textarea {
  width: 100%;
  min-height: 80px;
  resize: vertical;
}

/* Items section */
.items-section {
  margin: 1rem 0;
}

.item-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
}

.item-row input[type="text"] {
  flex: 1;
}

.qty-input {
  width: 60px;
  text-align: center;
}

/* Tab styling */
.sheet-tabs {
  display: flex;
  border-bottom: 1px solid var(--border-color);
  margin-bottom: 1rem;
}

.sheet-tabs .item {
  padding: 0.5rem 1rem;
  background: var(--background-medium);
  border: 1px solid var(--border-color);
  border-bottom: none;
  margin-right: 0.25rem;
  cursor: pointer;
  text-decoration: none;
  color: inherit;
}

.sheet-tabs .item.active {
  background: var(--border-color);
  border-color: rgba(255,255,255,0.3);
}

.sheet-tabs .item:hover {
  background: rgba(255,255,255,0.15);
}

.tab-content .tab {
  display: none;
}

.tab-content .tab.active {
  display: block;
}

/* Biography section */
.biography-section textarea {
  width: 100%;
  min-height: 200px;
  resize: vertical;
}

/* General button styling */
button {
  font-family: inherit;
}

button:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

/* Form spacing */
.form-group {
  margin-bottom: 0.75rem;
}

.form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 0.25rem;
}

.form-group input,
.form-group select,
.form-group textarea {
  width: 100%;
  padding: 0.25rem;
  border: 1px solid var(--border-color);
  background: var(--background-medium);
  color: inherit;
  border-radius: 3px;
}

.form-group input:focus,
.form-group select:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--color-primary);
  box-shadow: 0 0 0 2px var(--box-shadow);
}
  </style>
</head>
<body>
  <div class="preview-container">
    <div class="preview-header">
      <h1>PGTE Character Sheet Preview</h1>
      <p>Auto-generated from template - refresh this script to update</p>
    </div>

    <form class="pgte">
<form class=" flexcol" autocomplete="off">
  <header class="sheet-header">
    <h1 class="character-title"></h1>
    
    <div class="character-info">
      <div class="form-group">
        <label>Personal Name:</label>
        <input name="system.details.characterName" type="text" value="" placeholder="Character Name"/>
      </div>
      
      <div class="form-group">
        <label>Story Archetype:</label>
        <textarea name="system.details.archetype" rows="3" placeholder="Ambitious nobleman with delusions of grandeur">/></textarea>
      </div>
    </div>
  </header>

  <div class="sheet-body">
    <div class="tab-container">
      <nav class="sheet-tabs tabs" data-group="primary">
        <a class="item active" data-tab="main">Character Sheet</a>
        <a class="item" data-tab="biography">Notes</a>
      </nav>

      <div class="tab-content">
        <div class="tab main active" data-group="primary" data-tab="main">
    <!-- Stats Table -->
    <div class="stats-section">
      <h3>Stats</h3>
      <table class="stats-table">
        <thead>
          <tr>
            <th>Stat</th>
            <th>Uses</th>
            <th>Die</th>
          </tr>
        </thead>
        <tbody>
          {{#each system.stats as |stat key|}}
          <tr>
            <td class="stat-name">
              <button type="button" class="roll-stat-name" data-stat="" data-die=""></button>
            </td>
            <td class="stat-uses"></td>
            <td class="stat-die">
              <select name="system.stats..value">
                <option value="d4" >d4</option>
                <option value="d6" >d6</option>
                <option value="d8" >d8</option>
                <option value="d10" >d10</option>
                <option value="d12" >d12</option>
                <option value="d20" >d20</option>
              </select>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>

    <!-- Resources Row -->
    <div class="resources-row">
      <div class="resource-group">
        <h4>Hits <span style="opacity: var(--hits-mental-display-label, 0);">(Physical)</span></h4>
        <div class="hits-section">
          <div class="hits-control">
            <div class="toggle-buttons">
              <button type="button" class="hits-up">▲</button>
              <button type="button" class="hits-down">▼</button>
            </div>
            <div class="hits-display">
              
                <span class="hit-marker filled">●</span>
              
                <span class="hit-marker filled">●</span>
              
                <span class="hit-marker filled">●</span>
              
              
                <span class="hit-marker empty">○</span>
              
                <span class="hit-marker empty">○</span>
              
                <span class="hit-marker empty">○</span>
              
            </div>
          </div>
          <div class="hits-label-row">
            <label>Max: <input name="system.resources.hits.physical.max" type="number" value="6" min="1" max="10" class="base-hits"/></label>
          </div>
        </div>
      </div>
      
      <div class="resource-group">
        <h4>Hits (Mental)</h4>
        <div class="hits-section">
          <div class="hits-control">
            <div class="toggle-buttons">
              <button type="button" class="hits-up">▲</button>
              <button type="button" class="hits-down">▼</button>
            </div>
            <div class="hits-display">
              
                <span class="hit-marker filled">●</span>
              
              
                <span class="hit-marker empty">○</span>
              
                <span class="hit-marker empty">○</span>
              
                <span class="hit-marker empty">○</span>
              
            </div>
          </div>
          <div class="hits-label-row">
            <label>Max: <input name="system.resources.hits.mental.max" type="number" value="4" min="1" max="10" class="base-hits"/></label>
          </div>
        </div>
      </div>
      
      <div class="resource-group">
        <h4>Story Tokens</h4>
        <div class="tokens-section">
          <div class="tokens-control">
            <div class="toggle-buttons">
              <button type="button" class="tokens-up">▲</button>
              <button type="button" class="tokens-down">▼</button>
            </div>
            <input name="system.resources.storyTokens.value" type="number" value="2" min="0" class="tokens-input" placeholder="0"/>
          </div>
          <div class="hits-label-row" style="visibility: hidden; height: auto;">
            <label>Max: <input type="number" min="1" max="10" class="base-hits" style="visibility: hidden;"/></label>
          </div>
        </div>
      </div>
      
      <div class="resource-group">
        <h4>Story Die</h4>
        <div class="story-die-control">
          <button type="button" class="roll-story-die">Roll Story Die</button>
          <select name="system.resources.storyDie.value" class="story-die-select">
            <option value="d4" >d4</option>
            <option value="d6" selected>d6</option>
            <option value="d8" >d8</option>
            <option value="d10" >d10</option>
            <option value="d12" >d12</option>
            <option value="d20" >d20</option>
          </select>
        </div>
      </div>
    </div>

    <p style="font-style: italic; margin-top: 0.5rem; text-align: center;">Hits regenerate at 1 Hit per scene</p>

    <!-- Aspects in 3 columns -->
    <div class="aspects-section">
      <h3>Aspects</h3>
      <p><em>Choose 2 at start, gain 3rd through play</em></p>
      
      <div class="aspects-grid">
        <div class="aspect-column">
          <div class="aspect-block">
            <div class="aspect-header">
              <label>1st Aspect:</label>
              <input name="system.aspects.aspect1.name" type="text" value="" placeholder="Aspect Name"/>
            </div>
            <div class="aspect-details">
              <div class="form-group">
                <label>Nature:</label>
                <textarea name="system.aspects.aspect1.nature" rows="2" placeholder="Its groove in the story"></textarea>
              </div>
              <div class="aspect-buttons">
                <button type="button" class="roll-aspect" data-die="d4" data-type="Passive" data-name="">+D4 Passive</button>
                <button type="button" class="roll-aspect" data-die="d12" data-type="Active" data-name="">+D12 Active</button>
              </div>
            </div>
          </div>
        </div>

        <div class="aspect-column">
          <div class="aspect-block">
            <div class="aspect-header">
              <label>2nd Aspect:</label>
              <input name="system.aspects.aspect2.name" type="text" value="" placeholder="Aspect Name"/>
            </div>
            <div class="aspect-details">
              <div class="form-group">
                <label>Nature:</label>
                <textarea name="system.aspects.aspect2.nature" rows="2" placeholder="Its groove in the story"></textarea>
              </div>
              <div class="aspect-buttons">
                <button type="button" class="roll-aspect" data-die="d4" data-type="Passive" data-name="">+D4 Passive</button>
                <button type="button" class="roll-aspect" data-die="d12" data-type="Active" data-name="">+D12 Active</button>
              </div>
            </div>
          </div>
        </div>

        <div class="aspect-column">
          <div class="aspect-block">
            <div class="aspect-header">
              <label>3rd Aspect:</label>
              <input name="system.aspects.aspect3.name" type="text" value="" placeholder="Aspect Name"/>
            </div>
            <div class="aspect-details">
              <div class="form-group">
                <label>Nature:</label>
                <textarea name="system.aspects.aspect3.nature" rows="2" placeholder="Its groove in the story"></textarea>
              </div>
              <div class="aspect-buttons">
                <button type="button" class="roll-aspect" data-die="d4" data-type="Passive" data-name="">+D4 Passive</button>
                <button type="button" class="roll-aspect" data-die="d20" data-type="Active" data-name="">+D20 Active</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Magical Item Dice and Rule of Cool -->
    <div class="bonus-dice-section">
      <div class="item-dice-group">
        <h4>Magical Items</h4>
        <div class="item-dice-row">
          <input name="system.bonusDice.item1.name" type="text" value="" placeholder="Item"/>
          <select name="system.bonusDice.item1.die">
            <option value="">—</option>
            <option value="d4" >d4</option>
            <option value="d6" >d6</option>
            <option value="d8" >d8</option>
            <option value="d10" >d10</option>
            <option value="d12" >d12</option>
            <option value="d20" >d20</option>
          </select>
          <button type="button" class="roll-item" data-die="" data-name="">Roll</button>
        </div>
        <div class="item-dice-row">
          <input name="system.bonusDice.item2.name" type="text" value="" placeholder="Item"/>
          <select name="system.bonusDice.item2.die">
            <option value="">—</option>
            <option value="d4" >d4</option>
            <option value="d6" >d6</option>
            <option value="d8" >d8</option>
            <option value="d10" >d10</option>
            <option value="d12" >d12</option>
            <option value="d20" >d20</option>
          </select>
          <button type="button" class="roll-item" data-die="" data-name="">Roll</button>
        </div>
        <div class="item-dice-row">
          <input name="system.bonusDice.item3.name" type="text" value="" placeholder="Item"/>
          <select name="system.bonusDice.item3.die">
            <option value="">—</option>
            <option value="d4" >d4</option>
            <option value="d6" >d6</option>
            <option value="d8" >d8</option>
            <option value="d10" >d10</option>
            <option value="d12" >d12</option>
            <option value="d20" >d20</option>
          </select>
          <button type="button" class="roll-item" data-die="" data-name="">Roll</button>
        </div>
      </div>

      <div class="rule-of-cool-group">
        <h4>Rule of Cool</h4>
        <button type="button" class="roll-extra" data-die="d4">Roll D4</button>
      </div>
    </div>

    <!-- Items List -->
    <div class="items-section">
      <h3>Items</h3>
      <div class="items-list">
        <div class="item-row">
          <input name="system.equipment.item1.name" type="text" value="" placeholder="Item Name"/>
          <input name="system.equipment.item1.quantity" type="number" value="" min="0" class="qty-input"/>
          <div class="toggle-buttons">
            <button type="button" class="item-qty-up" data-item="item1">▲</button>
            <button type="button" class="item-qty-down" data-item="item1">▼</button>
          </div>
        </div>
        <div class="item-row">
          <input name="system.equipment.item2.name" type="text" value="" placeholder="Item Name"/>
          <input name="system.equipment.item2.quantity" type="number" value="" min="0" class="qty-input"/>
          <div class="toggle-buttons">
            <button type="button" class="item-qty-up" data-item="item2">▲</button>
            <button type="button" class="item-qty-down" data-item="item2">▼</button>
          </div>
        </div>
        <div class="item-row">
          <input name="system.equipment.item3.name" type="text" value="" placeholder="Item Name"/>
          <input name="system.equipment.item3.quantity" type="number" value="" min="0" class="qty-input"/>
          <div class="toggle-buttons">
            <button type="button" class="item-qty-up" data-item="item3">▲</button>
            <button type="button" class="item-qty-down" data-item="item3">▼</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Pattern of Three Notes -->
    <div class="notes-section">
      <div class="notes-label">
        <label>Patterns of Three:</label>
      </div>
      <div class="notes-area">
        <textarea name="system.notes.patternOfThree" rows="3" placeholder="Notes about patterns, recurring themes, or story elements..."></textarea>
      </div>
    </div>
        </div>

        <div class="tab biography" data-group="primary" data-tab="biography">
          <div class="character-details-section">
            <div class="form-row">
              <div class="form-group expanded">
                <label>Praesi Virtues:</label>
                <textarea name="system.details.praesiVirtues" rows="3" placeholder="Virtues"></textarea>
              </div>
              
              <div class="form-group expanded">
                <label>Major Flaws:</label>
                <textarea name="system.details.majorFlaws" rows="3" placeholder="Major Flaws"></textarea>
              </div>
            </div>
          </div>
          
          <div class="biography-section">
            <h3>Biography & Notes</h3>
            <textarea name="system.biography" rows="10" placeholder="Character backstory, motivations, connections, etc."></textarea>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
    </form>
  </div>
</body>
</html>
